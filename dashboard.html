<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Live Bus Tracking | Smart Fleet System</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #f9fafb;
      color: #111827;
    }
    header {
      background: #2563eb;
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
    }
    #map {
      height: 80vh;
      width: 100%;
    }
    #info {
      text-align: center;
      padding: 10px;
      font-size: 1.1rem;
    }
  </style>
</head>
<body>
  <header>üöå Live Bus Tracking</header>

  <div id="info">Fetching live GPS data...</div>
  <div id="map"></div>

  <!-- ‚úÖ Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <script>
    // üî• Your Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyCfPmCvSy6Fx-7j56elBkWnVygAZTxMVwo",
      authDomain: "smart-fleet-management-s-832af.firebaseapp.com",
      databaseURL: "https://smart-fleet-management-s-832af-default-rtdb.firebaseio.com",
      projectId: "smart-fleet-management-s-832af",
      storageBucket: "smart-fleet-management-s-832af.appspot.com",
      messagingSenderId: "712345678901",
      appId: "1:712345678901:web:abcdef123456"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let map, marker;

    function initMap() {
      const defaultLoc = { lat: 12.9716, lng: 77.5946 }; // Bengaluru
      map = new google.maps.Map(document.getElementById("map"), {
        zoom: 14,
        center: defaultLoc,
      });
      marker = new google.maps.Marker({
        position: defaultLoc,
        map: map,
        title: "Bus Location",
      });

      const infoDiv = document.getElementById("info");

      // üëá Listen to Firebase updates
      db.ref("gps/BUS-001").on("value", (snapshot) => {
        const data = snapshot.val();
        if (data && data.latitude && data.longitude) {
          const lat = parseFloat(data.latitude);
          const lng = parseFloat(data.longitude);
          const speed = data.speed || "N/A";
          const loc = { lat, lng };

          marker.setPosition(loc);
          map.setCenter(loc);
          infoDiv.innerHTML = `Bus BUS-001 ‚Üí üìç Lat: ${lat.toFixed(5)} | Lng: ${lng.toFixed(5)} | Speed: ${speed} km/h`;
        } else {
          infoDiv.innerHTML = "Waiting for GPS data...";
        }
      });
    }
  </script>

  <!-- ‚úÖ Google Maps API -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCfPmCvSy6Fx-7j56elBkWnVygAZTxMVwo&callback=initMap" async defer></script>
</body>
</html>
